{"version":3,"file":"index.js","sources":["../src/config.ts","../src/index.ts"],"sourcesContent":["import { cosmiconfigSync } from 'cosmiconfig'\nimport type { Config, State } from '@svgr/core'\n\nconst explorer = cosmiconfigSync('svgo', {\n  searchPlaces: [\n    'package.json',\n    '.svgorc',\n    '.svgorc.js',\n    '.svgorc.json',\n    '.svgorc.yaml',\n    '.svgorc.yml',\n    'svgo.config.js',\n    '.svgo.yml',\n  ],\n  transform: (result) => result && result.config,\n  cache: true,\n})\n\nconst getSvgoConfigFromSvgrConfig = (config: Config): any => {\n  const params = { overrides: {} as any }\n  if (config.icon || config.dimensions === false) {\n    params.overrides.removeViewBox = false\n  }\n  if (config.native) {\n    params.overrides.inlineStyles = {\n      onlyMatchedOnce: false,\n    }\n  }\n\n  return {\n    plugins: [\n      {\n        name: 'preset-default',\n        params,\n      },\n      'prefixIds',\n    ],\n  }\n}\n\nexport const getSvgoConfig = (config: Config, state: State): any => {\n  const cwd = state.filePath || process.cwd()\n  if (config.svgoConfig) return config.svgoConfig\n  if (config.runtimeConfig) {\n    const userConfig = explorer.search(cwd)\n    if (userConfig) return userConfig\n  }\n  return getSvgoConfigFromSvgrConfig(config)\n}\n","import { optimize } from 'svgo'\nimport { getSvgoConfig } from './config'\nimport type { Plugin } from '@svgr/core'\n\nconst svgoPlugin: Plugin = (code, config, state) => {\n  if (!config.svgo) return code\n  const svgoConfig = getSvgoConfig(config, state)\n  const result = optimize(code, { ...svgoConfig, path: state.filePath })\n\n  // @ts-ignore\n  if (result.modernError) {\n    // @ts-ignore\n    throw result.modernError\n  }\n\n  return result.data\n}\n\nexport default svgoPlugin\n"],"names":["cosmiconfigSync","optimize"],"mappings":";;;;;AAGA,MAAM,WAAWA,4BAAgB,QAAQ;AAAA,EACvC,cAAc;AAAA,IACZ;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA;AAAA,EAEF,WAAW,CAAC,WAAW,UAAU,OAAO;AAAA,EACxC,OAAO;AAAA;AAGT,MAAM,8BAA8B,CAAC,WAAwB;AAC3D,QAAM,SAAS,EAAE,WAAW;AAC5B,MAAI,OAAO,QAAQ,OAAO,eAAe,OAAO;AAC9C,WAAO,UAAU,gBAAgB;AAAA;AAEnC,MAAI,OAAO,QAAQ;AACjB,WAAO,UAAU,eAAe;AAAA,MAC9B,iBAAiB;AAAA;AAAA;AAIrB,SAAO;AAAA,IACL,SAAS;AAAA,MACP;AAAA,QACE,MAAM;AAAA,QACN;AAAA;AAAA,MAEF;AAAA;AAAA;AAAA;MAKO,gBAAgB,CAAC,QAAgB,UAAsB;AAClE,QAAM,MAAM,MAAM,YAAY,QAAQ;AACtC,MAAI,OAAO;AAAY,WAAO,OAAO;AACrC,MAAI,OAAO,eAAe;AACxB,UAAM,aAAa,SAAS,OAAO;AACnC,QAAI;AAAY,aAAO;AAAA;AAEzB,SAAO,4BAA4B;AAAA;;;;;;;;;;;;;;;;;;;;;MC3C/B,aAAqB,CAAC,MAAM,QAAQ,UAAU;AAClD,MAAI,CAAC,OAAO;AAAM,WAAO;AACzB,QAAM,aAAa,cAAc,QAAQ;AACzC,QAAM,SAASC,cAAS,MAAM,iCAAK,aAAL,EAAiB,MAAM,MAAM;AAG3D,MAAI,OAAO,aAAa;AAEtB,UAAM,OAAO;AAAA;AAGf,SAAO,OAAO;AAAA;;;;"}