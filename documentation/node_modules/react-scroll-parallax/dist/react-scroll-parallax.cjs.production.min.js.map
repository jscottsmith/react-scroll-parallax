{"version":3,"file":"react-scroll-parallax.cjs.production.min.js","sources":["../src/helpers/getIsolatedParallaxProps.ts","../src/utils/removeUndefinedObjectKeys.ts","../src/context/ParallaxContext.ts","../src/hooks/useParallaxController.ts","../src/hooks/useParallax.ts","../src/components/Parallax/hooks.ts","../src/components/ParallaxBanner/helpers/getExpandedStyle.ts","../src/components/ParallaxBanner/components/ParallaxBannerLayer.tsx","../src/components/ParallaxBanner/helpers/getImageStyle.ts","../src/components/ParallaxBanner/index.tsx","../src/components/ParallaxProvider/index.tsx","../src/components/ParallaxProvider/helpers.ts","../src/components/Parallax/index.tsx"],"sourcesContent":["import { ParallaxElementConfig } from 'parallax-controller';\nimport { removeUndefinedObjectKeys } from '../utils/removeUndefinedObjectKeys';\n\nexport function getIsolatedParallaxProps(props: any): {\n  parallaxProps: ParallaxElementConfig;\n  rest: Record<string, any>;\n} {\n  const {\n    disabled,\n    easing,\n    endScroll,\n    onChange,\n    onEnter,\n    onExit,\n    onProgressChange,\n    opacity,\n    rootMargin,\n    rotate,\n    rotateX,\n    rotateY,\n    rotateZ,\n    scale,\n    scaleX,\n    scaleY,\n    scaleZ,\n    shouldAlwaysCompleteAnimation,\n    shouldDisableScalingTranslations,\n    speed,\n    startScroll,\n    targetElement,\n    translateX,\n    translateY,\n    ...rest\n  } = props;\n\n  const parallaxProps = removeUndefinedObjectKeys({\n    disabled,\n    easing,\n    endScroll,\n    onChange,\n    onEnter,\n    onExit,\n    onProgressChange,\n    opacity,\n    rootMargin,\n    rotate,\n    rotateX,\n    rotateY,\n    rotateZ,\n    scale,\n    scaleX,\n    scaleY,\n    scaleZ,\n    shouldAlwaysCompleteAnimation,\n    shouldDisableScalingTranslations,\n    speed,\n    startScroll,\n    targetElement,\n    translateX,\n    translateY,\n  });\n\n  return {\n    parallaxProps,\n    rest,\n  };\n}\n","export function removeUndefinedObjectKeys(obj: { [key: string]: any }) {\n  Object.keys(obj).forEach((key) =>\n    obj[key] === undefined ? delete obj[key] : {}\n  );\n  return obj;\n}\n","import React from 'react';\nimport { ParallaxController } from 'parallax-controller';\n\nexport const ParallaxContext = React.createContext<ParallaxController | null>(\n  null\n);\n","import { useContext } from 'react';\nimport { ParallaxController } from 'parallax-controller';\nimport { ParallaxContext } from '../context/ParallaxContext';\n\nexport function useParallaxController(): ParallaxController | null {\n  const parallaxController = useContext(ParallaxContext);\n  const isServer = typeof window === 'undefined';\n  if (isServer) {\n    return null;\n  }\n\n  if (!parallaxController) {\n    throw new Error(\n      'Could not find `react-scroll-parallax` context value. Please ensure the component is wrapped in a <ParallaxProvider>'\n    );\n  }\n\n  return parallaxController;\n}\n","import { CreateElementOptions, Element } from 'parallax-controller';\nimport { useEffect, useRef, useState } from 'react';\nimport { useVerifyController } from '../components/Parallax/hooks';\nimport { ParallaxProps } from '../components/Parallax/types';\nimport { getIsolatedParallaxProps } from '../helpers/getIsolatedParallaxProps';\nimport { useParallaxController } from './useParallaxController';\n\nexport function useParallax<T extends HTMLElement>(props: ParallaxProps) {\n  const controller = useParallaxController();\n  const ref = useRef<T>(null);\n  const { parallaxProps } = getIsolatedParallaxProps(props);\n\n  useVerifyController(controller);\n\n  const [element, setElement] = useState<Element>();\n\n  // create element\n  useEffect(() => {\n    let newElement: Element | undefined;\n    if (ref.current instanceof HTMLElement) {\n      const options: CreateElementOptions = {\n        el: ref.current,\n        props: parallaxProps,\n      };\n      newElement = controller?.createElement(options);\n      setElement(newElement);\n    } else {\n      throw new Error(\n        'You must assign the ref returned by the useParallax() hook to an HTML Element.'\n      );\n    }\n\n    return () => {\n      if (newElement) {\n        controller?.removeElementById(newElement.id);\n      }\n    };\n  }, []);\n\n  // update element\n  useEffect(() => {\n    if (element) {\n      if (props.disabled) {\n        controller?.resetElementStyles(element);\n      } else {\n        controller?.updateElementPropsById(element.id, parallaxProps);\n      }\n    }\n  }, [\n    props.disabled,\n    props.easing,\n    props.endScroll,\n    props.onChange,\n    props.onEnter,\n    props.onExit,\n    props.onProgressChange,\n    props.opacity,\n    props.rootMargin,\n    props.rotate,\n    props.rotateX,\n    props.rotateY,\n    props.rotateZ,\n    props.scale,\n    props.scaleX,\n    props.scaleY,\n    props.scaleZ,\n    props.shouldAlwaysCompleteAnimation,\n    props.shouldDisableScalingTranslations,\n    props.speed,\n    props.startScroll,\n    props.targetElement,\n    props.translateX,\n    props.translateY,\n  ]);\n\n  return { ref, controller, element };\n}\n","import { ParallaxController } from 'parallax-controller';\nimport { useEffect } from 'react';\n\nexport function useVerifyController(controller: ParallaxController | unknown) {\n  useEffect(() => {\n    const isServer = typeof window === 'undefined';\n    // Make sure the provided controller is an instance of the Parallax Controller\n    const isInstance = controller instanceof ParallaxController;\n    // Throw if neither context or global is available\n    if (!isServer && !controller && !isInstance) {\n      throw new Error(\n        \"Must wrap your application's <Parallax /> components in a <ParallaxProvider />.\"\n      );\n    }\n  }, [controller]);\n}\n","import { parseValueAndUnit } from 'parallax-controller';\nimport { BannerLayer } from '../types';\n\nconst FALLBACK_RECT = {\n  height: 0,\n};\n\nexport function getExpandedStyle(layer: BannerLayer) {\n  if (Array.isArray(layer.translateY)) {\n    const translateYStart = parseValueAndUnit(layer.translateY[0]);\n    const translateYEnd = parseValueAndUnit(layer.translateY[1]);\n\n    if (translateYStart.unit === 'px' && translateYEnd.unit === 'px') {\n      return {\n        top: `${Math.abs(translateYEnd.value) * -1}px`,\n        bottom: `${Math.abs(translateYStart.value) * -1}px`,\n      };\n    }\n\n    if (translateYStart.unit === '%' && translateYEnd.unit === '%') {\n      const clientRect =\n        layer.targetElement?.getBoundingClientRect() || FALLBACK_RECT;\n      const top = Math.abs(clientRect.height * 0.01 * translateYEnd.value) * -1;\n      const bottom =\n        Math.abs(clientRect.height * 0.01 * translateYStart.value) * -1;\n      return {\n        top: `${top}px`,\n        bottom: `${bottom}px`,\n      };\n    }\n  }\n  if (layer.speed) {\n    const speed = layer.speed || 0;\n\n    return {\n      top: Math.abs(speed) * 10 * -1 + 'px',\n      bottom: Math.abs(speed) * 10 * -1 + 'px',\n    };\n  }\n  return {};\n}\n","import React, { CSSProperties } from 'react';\nimport { useParallax } from '../../..';\nimport { getIsolatedParallaxProps } from '../../../helpers/getIsolatedParallaxProps';\nimport { getExpandedStyle } from '../helpers/getExpandedStyle';\nimport { getImageStyle } from '../helpers/getImageStyle';\nimport { BannerLayer } from '../types';\n\nconst absoluteStyle: CSSProperties = {\n  position: 'absolute',\n  top: 0,\n  left: 0,\n  right: 0,\n  bottom: 0,\n};\n\nexport const ParallaxBannerLayer = (\n  props: BannerLayer & { testId: string }\n) => {\n  const { parallaxProps, rest } = getIsolatedParallaxProps(props);\n  const {\n    children,\n    disabled,\n    style,\n    expanded = true,\n    image,\n    testId,\n    ...divProps\n  } = rest;\n\n  const imageStyle = getImageStyle(props);\n  const expandedStyle = expanded ? getExpandedStyle(props) : {};\n  const parallax = useParallax<HTMLDivElement>({\n    targetElement: props.targetElement,\n    shouldDisableScalingTranslations: true,\n    ...parallaxProps,\n  });\n\n  return (\n    <div\n      data-testid={testId}\n      ref={parallax.ref}\n      style={{\n        ...imageStyle,\n        ...absoluteStyle,\n        ...expandedStyle,\n        ...style,\n      }}\n      {...divProps}\n    >\n      {rest.children}\n    </div>\n  );\n};\n","import { BannerLayer } from '../types';\n\nexport function getImageStyle(layer: BannerLayer) {\n  return layer.image\n    ? {\n        backgroundImage: `url(${layer.image})`,\n        backgroundPosition: 'center',\n        backgroundSize: 'cover',\n      }\n    : {};\n}\n","import React, {\n  PropsWithChildren,\n  CSSProperties,\n  useEffect,\n  useRef,\n  useState,\n} from 'react';\nimport { ParallaxBannerLayer } from './components/ParallaxBannerLayer';\nimport { ParallaxBannerProps } from './types';\n\nconst containerStyle: CSSProperties = {\n  position: 'relative',\n  overflow: 'hidden',\n  width: '100%',\n};\n\nexport const ParallaxBanner = (\n  props: PropsWithChildren<ParallaxBannerProps>\n) => {\n  const [targetElement, setTargetElement] = useState<HTMLDivElement | null>(\n    null\n  );\n  const containerRef = useRef<HTMLDivElement>(null);\n  useEffect(() => {\n    setTargetElement(containerRef.current);\n  }, []);\n  const {\n    disabled: disableAllLayers,\n    style: rootStyle,\n    layers = [],\n    ...rootRest\n  } = props;\n  return (\n    <div\n      ref={containerRef}\n      style={{ ...containerStyle, ...rootStyle }}\n      {...rootRest}\n    >\n      {layers.map(\n        (layer, i) =>\n          targetElement && (\n            <ParallaxBannerLayer\n              {...layer}\n              targetElement={targetElement}\n              key={`layer-${i}`}\n              testId={`layer-${i}`}\n            />\n          )\n      )}\n      {props.children}\n    </div>\n  );\n};\n","import React, { Component } from 'react';\n\nimport { ParallaxContext } from '../../context/ParallaxContext';\nimport { ParallaxController, ScrollAxis } from 'parallax-controller';\nimport { ParallaxProviderProps } from './types';\nimport { createController } from './helpers';\n\nexport class ParallaxProvider extends Component<ParallaxProviderProps, {}> {\n  static defaultProps = {\n    scrollAxis: ScrollAxis.vertical,\n  };\n\n  controller: ParallaxController | null;\n\n  constructor(props: ParallaxProviderProps) {\n    super(props);\n    this.controller = createController({\n      scrollAxis: props.scrollAxis,\n      scrollContainer: props.scrollContainer,\n    });\n  }\n\n  componentDidUpdate(prevProps: ParallaxProviderProps) {\n    if (prevProps.scrollContainer !== this.props.scrollContainer) {\n      // @ts-ignore\n      this.controller.updateScrollContainer(this.props.scrollContainer);\n    }\n  }\n\n  componentWillUnmount() {\n    // @ts-ignore\n    this.controller = this.controller.destroy();\n  }\n\n  render() {\n    const { children } = this.props;\n    return (\n      // @ts-ignore\n      <ParallaxContext.Provider value={this.controller}>\n        {children}\n      </ParallaxContext.Provider>\n    );\n  }\n}\n","import {\n  ParallaxController,\n  ParallaxControllerOptions,\n} from 'parallax-controller';\n\nexport const createController = (options: ParallaxControllerOptions) => {\n  // Don't initialize on the server\n  const isServer = typeof window === 'undefined';\n\n  if (!isServer) {\n    // Must not be the server so kick it off...\n    return ParallaxController.init(options);\n  }\n  return null;\n};\n","import React, { PropsWithChildren } from 'react';\nimport { getIsolatedParallaxProps } from '../../helpers/getIsolatedParallaxProps';\nimport { useParallax } from '../../hooks/useParallax';\nimport { ParallaxProps } from './types';\n\nexport function Parallax(props: PropsWithChildren<ParallaxProps>) {\n  const { parallaxProps, rest } = getIsolatedParallaxProps(props);\n  const { ref } = useParallax<HTMLDivElement>(parallaxProps);\n  return (\n    <div ref={ref} {...rest}>\n      {props.children}\n    </div>\n  );\n}\n"],"names":["getIsolatedParallaxProps","props","obj","disabled","easing","endScroll","onChange","onEnter","onExit","onProgressChange","opacity","rootMargin","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","shouldAlwaysCompleteAnimation","shouldDisableScalingTranslations","speed","startScroll","targetElement","translateX","translateY","rest","parallaxProps","Object","keys","forEach","key","undefined","ParallaxContext","React","createContext","useParallaxController","parallaxController","useContext","window","Error","useParallax","controller","ref","useRef","useEffect","ParallaxController","useVerifyController","useState","element","setElement","newElement","current","HTMLElement","createElement","el","removeElementById","id","resetElementStyles","updateElementPropsById","FALLBACK_RECT","height","absoluteStyle","position","top","left","right","bottom","ParallaxBannerLayer","layer","style","expanded","image","testId","divProps","imageStyle","backgroundImage","backgroundPosition","backgroundSize","expandedStyle","Array","isArray","translateYStart","parseValueAndUnit","translateYEnd","unit","Math","abs","value","clientRect","getBoundingClientRect","getExpandedStyle","parallax","children","containerStyle","overflow","width","ParallaxProvider","init","scrollAxis","scrollContainer","componentDidUpdate","prevProps","this","updateScrollContainer","componentWillUnmount","destroy","render","Provider","Component","ScrollAxis","vertical","setTargetElement","containerRef","rootStyle","layers","rootRest","map","i"],"mappings":"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"}