"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t,e,i,s,r,n,o=(t=require("bezier-easing"))&&"object"==typeof t&&"default"in t?t.default:t,a=function(t){this.startX=t.startX,this.startY=t.startY,this.endX=t.endX,this.endY=t.endY,this.totalX=this.endX-this.startX,this.totalY=this.endY-this.startY,this.startMultiplierX=t.startMultiplierX||1,this.endMultiplierX=t.endMultiplierX||1,this.startMultiplierY=t.startMultiplierY||1,this.endMultiplierY=t.endMultiplierY||1};function l(){return(l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t}).apply(this,arguments)}(e=exports.ValidCSSEffects||(exports.ValidCSSEffects={})).speed="speed",e.translateX="translateX",e.translateY="translateY",e.rotate="rotate",e.rotateX="rotateX",e.rotateY="rotateY",e.rotateZ="rotateZ",e.scale="scale",e.scaleX="scaleX",e.scaleY="scaleY",e.scaleZ="scaleZ",e.opacity="opacity",(i=exports.Units||(exports.Units={})).px="px",i["%"]="%",(s=exports.RotationUnits||(exports.RotationUnits={})).deg="deg",s.turn="turn",s.rad="rad",(exports.ScaleUnits||(exports.ScaleUnits={}))[""]="",(r=exports.ScrollAxis||(exports.ScrollAxis={})).vertical="vertical",r.horizontal="horizontal",(n=exports.EasingPreset||(exports.EasingPreset={})).ease="ease",n.easeIn="easeIn",n.easeOut="easeOut",n.easeInOut="easeInOut",n.easeInQuad="easeInQuad",n.easeInCubic="easeInCubic",n.easeInQuart="easeInQuart",n.easeInQuint="easeInQuint",n.easeInSine="easeInSine",n.easeInExpo="easeInExpo",n.easeInCirc="easeInCirc",n.easeOutQuad="easeOutQuad",n.easeOutCubic="easeOutCubic",n.easeOutQuart="easeOutQuart",n.easeOutQuint="easeOutQuint",n.easeOutSine="easeOutSine",n.easeOutExpo="easeOutExpo",n.easeOutCirc="easeOutCirc",n.easeInOutQuad="easeInOutQuad",n.easeInOutCubic="easeInOutCubic",n.easeInOutQuart="easeInOutQuart",n.easeInOutQuint="easeInOutQuint",n.easeInOutSine="easeInOutSine",n.easeInOutExpo="easeInOutExpo",n.easeInOutCirc="easeInOutCirc",n.easeInBack="easeInBack",n.easeOutBack="easeOutBack",n.easeInOutBack="easeInOutBack";var h=0;function u(){return++h}var c=function(){function t(t){var e=t.el.getBoundingClientRect();if(t.view.scrollContainer){var i=t.view.scrollContainer.getBoundingClientRect();e=l({},e,{top:e.top-i.top,right:e.right-i.left,bottom:e.bottom-i.top,left:e.left-i.left})}this.height=t.el.offsetHeight,this.width=t.el.offsetWidth,this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,t.rootMargin&&this._setRectWithRootMargin(t.rootMargin)}return t.prototype._setRectWithRootMargin=function(t){var e=t.top+t.bottom,i=t.left+t.right;this.top-=t.top,this.right+=t.right,this.bottom+=t.bottom,this.left-=t.left,this.height+=e,this.width+=i},t}(),d=[exports.ScaleUnits[""],exports.Units.px,exports.Units["%"],exports.RotationUnits.deg,exports.RotationUnits.turn,exports.RotationUnits.rad];function p(t,e){void 0===e&&(e=exports.Units["%"]);var i={value:0,unit:e};if(void 0===t)return i;if("number"!=typeof t&&"string"!=typeof t)throw new Error("Invalid value provided. Must provide a value as a string or number");if(t=String(t),i.value=parseFloat(t),i.unit=t.match(/[\d.\-+]*\s*(.*)/)[1]||e,!d.includes(i.unit))throw new Error("Invalid unit provided.");return i}var f={ease:[.25,.1,.25,1],easeIn:[.42,0,1,1],easeOut:[0,0,.58,1],easeInOut:[.42,0,.58,1],easeInQuad:[.55,.085,.68,.53],easeInCubic:[.55,.055,.675,.19],easeInQuart:[.895,.03,.685,.22],easeInQuint:[.755,.05,.855,.06],easeInSine:[.47,0,.745,.715],easeInExpo:[.95,.05,.795,.035],easeInCirc:[.6,.04,.98,.335],easeOutQuad:[.25,.46,.45,.94],easeOutCubic:[.215,.61,.355,1],easeOutQuart:[.165,.84,.44,1],easeOutQuint:[.23,1,.32,1],easeOutSine:[.39,.575,.565,1],easeOutExpo:[.19,1,.22,1],easeOutCirc:[.075,.82,.165,1],easeInOutQuad:[.455,.03,.515,.955],easeInOutCubic:[.645,.045,.355,1],easeInOutQuart:[.77,0,.175,1],easeInOutQuint:[.86,0,.07,1],easeInOutSine:[.445,.05,.55,.95],easeInOutExpo:[1,0,0,1],easeInOutCirc:[.785,.135,.15,.86],easeInBack:[.6,-.28,.735,.045],easeOutBack:[.175,.885,.32,1.275],easeInOutBack:[.68,-.55,.265,1.55]};function v(t){if(Array.isArray(t))return o(t[0],t[1],t[2],t[3]);if("string"==typeof t&&void 0!==f[t]){var e=f[t];return o(e[0],e[1],e[2],e[3])}}var g=Object.values(exports.ValidCSSEffects),m={speed:"px",translateX:"%",translateY:"%",rotate:"deg",rotateX:"deg",rotateY:"deg",rotateZ:"deg",scale:"",scaleX:"",scaleY:"",scaleZ:"",opacity:""};function w(t,e){var i={};return g.forEach((function(s){var r=m[s];if("number"==typeof(null==t?void 0:t[s])){var n=null==t?void 0:t[s],o=-10*(n||0)+"px",a=p(10*(n||0)+"px"),l=p(o),h={start:a.value,end:l.value,unit:a.unit};e===exports.ScrollAxis.vertical&&(i.translateY=h),e===exports.ScrollAxis.horizontal&&(i.translateX=h)}if(Array.isArray(null==t?void 0:t[s])){var u=null==t?void 0:t[s];if(void 0!==u[0]&&void 0!==u[1]){var c=p(null==u?void 0:u[0],r),d=p(null==u?void 0:u[1],r),f=v(null==u?void 0:u[2]);if(i[s]={start:c.value,end:d.value,unit:c.unit,easing:f},c.unit!==d.unit)throw new Error("Must provide matching units for the min and max offset values of each axis.")}}})),i}function x(t,e,i,s){var r=(i-t)/e;return s&&(r=s(r)),r}function E(t,e,i){return i>=t&&i<=e}function _(t,e,i,s,r){return(i-e)*(t-s)/(r-s)+e}function S(t,e){return{value:_("function"==typeof t.easing?t.easing(e):e,(null==t?void 0:t.start)||0,(null==t?void 0:t.end)||0,0,1),unit:null==t?void 0:t.unit}}var y=Object.values(exports.ValidCSSEffects).filter((function(t){return"opacity"!==t}));function I(t,e,i){if(i){var s=function(t,e){return y.reduce((function(i,s){var r=t[s]&&S(t[s],e);return void 0===r||void 0===r.value||void 0===r.unit?i:i+(s+"(")+r.value+r.unit+")"}),"")}(t,e),r=function(t,e){var i=t.opacity&&S(t.opacity,e);return void 0===i||void 0===i.value||void 0===i.unit?"":""+i.value}(t,e);i.style.transform=s,i.style.opacity=r}}function O(t){var e=t.el;e&&(e.style.transform="",e.style.opacity="")}function C(t,e,i){var s=e>t,r=(Math.abs(t)+Math.abs(e))*(s?-1:1);return Math.max(i/(i+r),1)}function b(t,e){var i=t.start,s=t.end;if("%"===t.unit){var r=e/100;i*=r,s*=r}return{start:i,end:s}}var A={start:0,end:0,unit:""},X=function(){function t(t){var e,i;this.el=t.el,this.props=t.props,this.scrollAxis=t.scrollAxis,this.id=u(),this.effects=w(this.props,this.scrollAxis),this.isInView=null,this.progress=0,this._setElementEasing(t.props.easing),e=t.el,i=Object.keys(this.effects).includes("opacity"),e.style.willChange="transform"+(i?",opacity":""),this.updatePosition=t.scrollAxis===exports.ScrollAxis.vertical?this._updatePositionVertical:this._updatePositionHorizontal}var e=t.prototype;return e.updateProps=function(t){return this.props=l({},this.props,t),this.effects=w(t,this.scrollAxis),this._setElementEasing(t.easing),this},e.setCachedAttributes=function(t,e){O(this),this.rect=new c({el:this.props.targetElement||this.el,rootMargin:this.props.rootMargin,view:t});var i,s,r,n=(s=this.effects,r=this.scrollAxis,!((i=this.props).rootMargin||i.targetElement||i.shouldDisableScalingTranslations||!(s.translateX&&r===exports.ScrollAxis.horizontal||s.translateY&&r===exports.ScrollAxis.vertical)));return"number"==typeof this.props.startScroll&&"number"==typeof this.props.endScroll?(this.limits=new a({startX:this.props.startScroll,startY:this.props.startScroll,endX:this.props.endScroll,endY:this.props.endScroll}),this):(n?(this.limits=function(t,e,i,s,r,n){var o=i.translateY||A,l=b(i.translateX||A,t.width),h=l.start,u=l.end,c=b(o,t.height),d=c.start,p=c.end,f=t.top-e.height,v=t.left-e.width,g=t.bottom,m=t.right,w=1,x=1;r===exports.ScrollAxis.vertical&&(x=w=C(d,p,e.height+t.height));var E=1,_=1;if(r===exports.ScrollAxis.horizontal&&(_=E=C(h,u,e.width+t.width)),d<0&&(f+=d*w),p>0&&(g+=p*x),h<0&&(v+=h*E),u>0&&(m+=u*_),v+=s.x,m+=s.x,f+=s.y,g+=s.y,n){var S=s.y+t.top<e.height,y=s.x+t.left<e.width,I=s.y+t.bottom>e.scrollHeight-e.height,O=s.x+t.right>e.scrollWidth-e.height;S&&I&&(w=1,x=1,f=0,g=e.scrollHeight-e.height),y&&O&&(E=1,_=1,v=0,m=e.scrollWidth-e.width),!S&&I&&(w=C(d,p,(g=e.scrollHeight-e.height)-(f=t.top-e.height+s.y)),x=1,d<0&&(f+=d*w)),!y&&O&&(E=C(h,u,(m=e.scrollWidth-e.width)-(v=t.left-e.width+s.x)),_=1,h<0&&(v+=h*E)),S&&!I&&(w=1,x=C(d,p,(g=t.bottom+s.y)-(f=0)),p>0&&(g+=p*x)),y&&!O&&(E=1,_=C(h,u,(m=t.right+s.x)-(v=0)),u>0&&(m+=u*_))}return new a({startX:v,startY:f,endX:m,endY:g,startMultiplierX:E,endMultiplierX:_,startMultiplierY:w,endMultiplierY:x})}(this.rect,t,this.effects,e,this.scrollAxis,this.props.shouldAlwaysCompleteAnimation),this.scaledEffects=function(t,e){var i=l({},t);return i.translateX&&(i.translateX=l({},t.translateX,{start:i.translateX.start*e.startMultiplierX,end:i.translateX.end*e.endMultiplierX})),i.translateY&&(i.translateY=l({},t.translateY,{start:i.translateY.start*e.startMultiplierY,end:i.translateY.end*e.endMultiplierY})),i}(this.effects,this.limits)):this.limits=function(t,e,i,s){var r=t.top-e.height,n=t.left-e.width,o=t.bottom,l=t.right;return n+=i.x,l+=i.x,r+=i.y,o+=i.y,s&&(i.y+t.top<e.height&&(r=0),i.x+t.left<e.width&&(n=0),o>e.scrollHeight-e.height&&(o=e.scrollHeight-e.height),l>e.scrollWidth-e.width&&(l=e.scrollWidth-e.width)),new a({startX:n,startY:r,endX:l,endY:o})}(this.rect,t,e,this.props.shouldAlwaysCompleteAnimation),this._setElementStyles(),this)},e._updateElementIsInView=function(t){t!==this.isInView&&(t?this.props.onEnter&&this.props.onEnter():(this._setFinalStylesAndProgress(),this.props.onExit&&this.props.onExit())),this.isInView=t},e._setFinalStylesAndProgress=function(){var t=Math.round(this.progress);this._updateElementProgress(t)},e._setElementStyles=function(){this.props.disabled||I(this.scaledEffects||this.effects,this.progress,this.el)},e._updateElementProgress=function(t){this.progress=t,this.props.onProgressChange&&this.props.onProgressChange(this.progress),this.props.onChange&&this.props.onChange(this),this._setElementStyles()},e._setElementEasing=function(t){this.easing=v(t)},e._updatePositionHorizontal=function(t){if(!this.limits)return this;var e=E(this.limits.startX,this.limits.endX,t.x);if(this._updateElementIsInView(e),!e)return this;var i=x(this.limits.startX,this.limits.totalX,t.x,this.easing);return this._updateElementProgress(i),this},e._updatePositionVertical=function(t){if(!this.limits)return this;var e=E(this.limits.startY,this.limits.endY,t.y);if(this._updateElementIsInView(e),!this.isInView)return this;var i=x(this.limits.startY,this.limits.totalY,t.y,this.easing);return this._updateElementProgress(i),this},t}(),Y=function(){function t(t){var e=t.width,i=t.height,s=t.scrollHeight,r=t.scrollWidth;this.scrollContainer=t.scrollContainer,this.width=e,this.height=i,this.scrollHeight=s,this.scrollWidth=r}return t.prototype.setSize=function(t){var e=t.height,i=t.scrollHeight,s=t.scrollWidth;return this.width=t.width,this.height=e,this.scrollHeight=i,this.scrollWidth=s,this},t}(),P=function(){function t(t,e){this.x=t,this.y=e,this.dx=0,this.dy=0}return t.prototype.setScroll=function(t,e){return this.dx=t-this.x,this.dy=e-this.y,this.x=t,this.y=e,this},t}();function M(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){return t=!0,!0}});window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(t){}return t}var z=function(){function t(t){var e=t.scrollAxis,i=void 0===e?exports.ScrollAxis.vertical:e,s=t.scrollContainer;this.scrollAxis=i,this.elements=[],this._hasScrollContainer=!!s,this.viewEl=null!=s?s:window;var r=this._getScrollPosition();this.scroll=new P(r[0],r[1]),this.view=new Y({width:0,height:0,scrollWidth:0,scrollHeight:0,scrollContainer:this._hasScrollContainer?s:void 0}),this._ticking=!1,this._supportsPassive=M(),this._bindAllMethods(),this._addListeners(this.viewEl),this._addResizeObserver(),this._setViewSize()}t.init=function(e){if("undefined"==typeof window)throw new Error("Looks like ParallaxController.init() was called on the server. This method must be called on the client.");return new t(e)};var e=t.prototype;return e._bindAllMethods=function(){var t=this;["_addListeners","_removeListeners","_getScrollPosition","_handleScroll","_handleUpdateCache","_updateAllElements","_updateElementPosition","_setViewSize","_addResizeObserver","getElements","createElement","removeElementById","resetElementStyles","updateElementPropsById","update","updateScrollContainer","destroy"].forEach((function(e){t[e]=t[e].bind(t)}))},e._addListeners=function(t){t.addEventListener("scroll",this._handleScroll,!!this._supportsPassive&&{passive:!0}),window.addEventListener("resize",this._handleUpdateCache,!1),window.addEventListener("blur",this._handleUpdateCache,!1),window.addEventListener("focus",this._handleUpdateCache,!1),window.addEventListener("load",this._handleUpdateCache,!1)},e._removeListeners=function(t){var e;t.removeEventListener("scroll",this._handleScroll,!1),window.removeEventListener("resize",this._handleUpdateCache,!1),window.removeEventListener("blur",this._handleUpdateCache,!1),window.removeEventListener("focus",this._handleUpdateCache,!1),window.removeEventListener("load",this._handleUpdateCache,!1),null==(e=this._resizeObserver)||e.disconnect()},e._addResizeObserver=function(){var t=this;try{var e=this._hasScrollContainer?this.viewEl:document.documentElement;this._resizeObserver=new ResizeObserver((function(){return t.update()})),this._resizeObserver.observe(e)}catch(t){console.warn("Failed to create the resize observer in the ParallaxContoller")}},e._getScrollPosition=function(){return[this._hasScrollContainer?this.viewEl.scrollLeft:window.pageXOffset,this._hasScrollContainer?this.viewEl.scrollTop:window.pageYOffset]},e._handleScroll=function(){var t=this._getScrollPosition();this.scroll.setScroll(t[0],t[1]),!this._ticking&&this.elements.length>0&&(this._ticking=!0,window.requestAnimationFrame(this._updateAllElements))},e._handleUpdateCache=function(){this._setViewSize(),this._updateAllElements({updateCache:!0})},e._updateAllElements=function(t){var e=this,i=(void 0===t?{}:t).updateCache;this.elements&&this.elements.forEach((function(t){i&&t.setCachedAttributes(e.view,e.scroll),e._updateElementPosition(t)})),this._ticking=!1},e._updateElementPosition=function(t){t.props.disabled||t.updatePosition(this.scroll)},e._setViewSize=function(){if(this._hasScrollContainer)return this.view.setSize({width:this.viewEl.offsetWidth,height:this.viewEl.offsetHeight,scrollHeight:this.viewEl.scrollHeight,scrollWidth:this.viewEl.scrollWidth});var t=document.documentElement,e=window.innerWidth||t.clientWidth,i=window.innerHeight||t.clientHeight;return this.view.setSize({width:e,height:i,scrollHeight:t.scrollHeight,scrollWidth:t.scrollWidth})},e.getElements=function(){return this.elements},e.createElement=function(t){var e=new X(l({},t,{scrollAxis:this.scrollAxis}));return e.setCachedAttributes(this.view,this.scroll),this.elements=this.elements?[].concat(this.elements,[e]):[e],this._updateElementPosition(e),e},e.removeElementById=function(t){this.elements&&(this.elements=this.elements.filter((function(e){return e.id!==t})))},e.updateElementPropsById=function(t,e){this.elements&&(this.elements=this.elements.map((function(i){return i.id===t?i.updateProps(e):i}))),this.update()},e.resetElementStyles=function(t){O(t)},e.update=function(){var t=this._getScrollPosition();this.scroll.setScroll(t[0],t[1]),this._setViewSize(),this._updateAllElements({updateCache:!0})},e.updateScrollContainer=function(t){this._removeListeners(this.viewEl),this.viewEl=t,this._hasScrollContainer=!!t,this.view=new Y({width:0,height:0,scrollWidth:0,scrollHeight:0,scrollContainer:t}),this._setViewSize(),this._addListeners(this.viewEl),this._updateAllElements({updateCache:!0})},e.destroy=function(){this._removeListeners(this.viewEl),this.elements&&this.elements.forEach((function(t){return O(t)})),this.elements=void 0},t}();exports.Element=X,exports.Limits=a,exports.ParallaxController=z,exports.Rect=c,exports.Scroll=P,exports.View=Y,exports.createId=u,exports.getProgressAmount=x,exports.isElementInView=E,exports.parseElementTransitionEffects=w,exports.parseValueAndUnit=p,exports.resetStyles=O,exports.scaleBetween=_,exports.scaleEffectByProgress=S,exports.setElementStyles=I,exports.testForPassiveScroll=M;
//# sourceMappingURL=parallax-controller.cjs.production.min.js.map
