"use strict";var React=require("react"),ReactDOM=require("react-dom"),invariant=require("invariant"),throttleDebounce=require("throttle-debounce"),createResizeDetector=require("element-resize-detector"),isShallowEqual=require("shallowequal");function _interopDefaultLegacy(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var React__default=_interopDefaultLegacy(React),ReactDOM__default=_interopDefaultLegacy(ReactDOM),invariant__default=_interopDefaultLegacy(invariant),createResizeDetector__default=_interopDefaultLegacy(createResizeDetector),isShallowEqual__default=_interopDefaultLegacy(isShallowEqual);function ownKeys(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function _objectSpread2(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _extends(){return(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};for(var r,n={},i=Object.keys(e),o=0;o<i.length;o++)r=i[o],0<=t.indexOf(r)||(n[r]=e[r]);return n}function _objectWithoutProperties(e,t){if(null==e)return{};var r,n=_objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols)for(var i=Object.getOwnPropertySymbols(e),o=0;o<i.length;o++)r=i[o],0<=t.indexOf(r)||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r]);return n}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _possibleConstructorReturn(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _createSuper(r){var n=_isNativeReflectConstruct();return function(){var e,t=_getPrototypeOf(r);return _possibleConstructorReturn(this,n?(e=_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}var instances={};function resizeDetector(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"scroll";return instances[e]||(instances[e]=createResizeDetector__default.default({strategy:e})),instances[e]}var _excluded$1=["explicitRef","className","style","size","disablePlaceholder","onSize"],errMsg="react-sizeme: an error occurred whilst stopping to listen to node size changes",defaultConfig={monitorWidth:!0,monitorHeight:!1,refreshRate:16,refreshMode:"throttle",noPlaceholder:!1,resizeDetectorStrategy:"scroll"};function getDisplayName(e){return e.displayName||e.name||"Component"}var ReferenceWrapper=function(){_inherits(t,React.Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"render",value:function(){return React.Children.only(this.props.children)}}]),t}();function Placeholder(e){var t=e.className,r=e.style,e={};return t||r?(t&&(e.className=t),r&&(e.style=r)):e.style={width:"100%",height:"100%"},React__default.default.createElement("div",e)}_defineProperty(ReferenceWrapper,"displayName","SizeMeReferenceWrapper"),Placeholder.displayName="SizeMePlaceholder";var renderWrapper=function(l){function e(e){var t=e.explicitRef,r=e.className,n=e.style,i=e.size,o=e.disablePlaceholder;e.onSize;var a=_objectWithoutProperties(e,_excluded$1),e=(null==i||null==i.width&&null==i.height)&&!o,o={className:r,style:n};null!=i&&(o.size=i);a=e?React__default.default.createElement(Placeholder,{className:r,style:n}):React__default.default.createElement(l,_extends({},o,a));return React__default.default.createElement(ReferenceWrapper,{ref:t},a)}return e.displayName="SizeMeRenderer(".concat(getDisplayName(l),")"),e};function withSize(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:defaultConfig,t=e.monitorWidth,a=void 0===t?defaultConfig.monitorWidth:t,r=e.monitorHeight,l=void 0===r?defaultConfig.monitorHeight:r,t=e.refreshRate,c=void 0===t?defaultConfig.refreshRate:t,r=e.refreshMode,t=void 0===r?defaultConfig.refreshMode:r,r=e.noPlaceholder,n=void 0===r?defaultConfig.noPlaceholder:r,e=e.resizeDetectorStrategy,s=void 0===e?defaultConfig.resizeDetectorStrategy:e;invariant__default.default(a||l,'You have to monitor at least one of the width or height when using "sizeMe"'),invariant__default.default(16<=c,"It is highly recommended that you don't put your refreshRate lower than 16 as this may cause layout thrashing."),invariant__default.default("throttle"===t||"debounce"===t,'The refreshMode should have a value of "throttle" or "debounce"');var u="throttle"===t?throttleDebounce.throttle:throttleDebounce.debounce;return function(e){var r=renderWrapper(e),t=function(){_inherits(o,React__default["default"].Component);var i=_createSuper(o);function o(){var r;_classCallCheck(this,o);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return _defineProperty(_assertThisInitialized(r=i.call.apply(i,[this].concat(t))),"domEl",null),_defineProperty(_assertThisInitialized(r),"state",{width:void 0,height:void 0}),_defineProperty(_assertThisInitialized(r),"uninstall",function(){if(r.domEl){try{r.detector.uninstall(r.domEl)}catch(e){console.warn(errMsg)}r.domEl=null}}),_defineProperty(_assertThisInitialized(r),"determineStrategy",function(e){e.onSize?(r.callbackState||(r.callbackState=_objectSpread2({},r.state)),r.strategy="callback"):r.strategy="render"}),_defineProperty(_assertThisInitialized(r),"strategisedSetState",function(e){"callback"===r.strategy&&(r.callbackState=e,r.props.onSize(e)),r.setState(e)}),_defineProperty(_assertThisInitialized(r),"strategisedGetState",function(){return"callback"===r.strategy?r.callbackState:r.state}),_defineProperty(_assertThisInitialized(r),"refCallback",function(e){r.element=e}),_defineProperty(_assertThisInitialized(r),"hasSizeChanged",function(e,t){return a&&e.width!==t.width||l&&e.height!==t.height}),_defineProperty(_assertThisInitialized(r),"checkIfSizeChanged",u(c,function(e){var t=e.getBoundingClientRect(),e=t.width,t=t.height,t={width:a?e:null,height:l?t:null};r.hasSizeChanged(r.strategisedGetState(),t)&&r.strategisedSetState(t)})),r}return _createClass(o,[{key:"componentDidMount",value:function(){this.detector=resizeDetector(s),this.determineStrategy(this.props),this.handleDOMNode()}},{key:"componentDidUpdate",value:function(){this.determineStrategy(this.props),this.handleDOMNode()}},{key:"componentWillUnmount",value:function(){this.hasSizeChanged=function(){},this.checkIfSizeChanged=function(){},this.uninstall()}},{key:"handleDOMNode",value:function(){var e=this.element&&ReactDOM__default.default.findDOMNode(this.element);e?this.domEl?(this.domEl.isSameNode&&!this.domEl.isSameNode(e)||this.domEl!==e)&&(this.uninstall(),this.domEl=e,this.detector.listenTo(this.domEl,this.checkIfSizeChanged)):(this.domEl=e,this.detector.listenTo(this.domEl,this.checkIfSizeChanged)):this.uninstall()}},{key:"render",value:function(){var e=withSize.enableSSRBehaviour||withSize.noPlaceholders||n||"callback"===this.strategy,t=_objectSpread2({},this.state);return React__default.default.createElement(r,_extends({explicitRef:this.refCallback,size:"callback"===this.strategy?null:t,disablePlaceholder:e},this.props))}}]),o}();return _defineProperty(t,"displayName","SizeMe(".concat(getDisplayName(e),")")),t.WrappedComponent=e,t}}withSize.enableSSRBehaviour=!1,withSize.noPlaceholders=!1;var _excluded=["children","render"],_excluded2=["children","render"],_excluded3=["children","render"],SizeMe=function(){_inherits(n,React.Component);var r=_createSuper(n);function n(e){var t;_classCallCheck(this,n),_defineProperty(_assertThisInitialized(t=r.call(this,e)),"createComponent",function(e){t.SizeAware=withSize(e)(function(e){return e.children})}),_defineProperty(_assertThisInitialized(t),"onSize",function(e){return t.setState({size:e})}),e.children,e.render;e=_objectWithoutProperties(e,_excluded);return t.createComponent(e),t.state={size:{width:void 0,height:void 0}},t}return _createClass(n,[{key:"componentDidUpdate",value:function(e){var t=this.props;t.children,t.render;t=_objectWithoutProperties(t,_excluded2);e.children,e.render;e=_objectWithoutProperties(e,_excluded3);isShallowEqual__default.default(t,e)||this.createComponent(t)}},{key:"render",value:function(){var e=this.SizeAware,t=this.props.children||this.props.render;return React__default.default.createElement(e,{onSize:this.onSize},t({size:this.state.size}))}}]),n}();_defineProperty(SizeMe,"defaultProps",{children:void 0,render:void 0}),withSize.SizeMe=SizeMe,withSize.withSize=withSize,module.exports=withSize;
//# sourceMappingURL=react-sizeme.min.js.map
